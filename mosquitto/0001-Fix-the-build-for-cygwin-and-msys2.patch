From 11a3eb58a5c6880adb18494d15bf3cceed983cc2 Mon Sep 17 00:00:00 2001
From: Ben Wijen <ben.wijen.external@cpp.canon>
Date: Fri, 30 Jan 2026 11:18:32 +0100
Subject: [PATCH] Fix the build for cygwin (and msys2)

---
 apps/db_dump/db_dump.c | 4 ++++
 src/conf.c             | 2 +-
 2 files changed, 5 insertions(+), 1 deletion(-)

diff --git a/apps/db_dump/db_dump.c b/apps/db_dump/db_dump.c
index 9cf48c82..acc550ae 100644
--- a/apps/db_dump/db_dump.c
+++ b/apps/db_dump/db_dump.c
@@ -38,6 +38,10 @@ Contributors:
 
 #include "db_dump.h"
 
+#ifdef __CYGWIN__
+#include <arpa/inet.h>
+#endif
+
 #ifdef __ANDROID__
 #include <sys/endian.h>
 #endif
diff --git a/src/conf.c b/src/conf.c
index 74f281e8..34235899 100644
--- a/src/conf.c
+++ b/src/conf.c
@@ -1820,7 +1820,7 @@ static int config__read_file_core(struct mosquitto__config *config, bool reload,
 					if(conf__parse_string(&token, "http_dir", &cur_listener->http_dir, &saveptr)){
 						return MOSQ_ERR_INVAL;
 					}
-#ifdef WIN32
+#if defined(WIN32) && !defined(__CYGWIN__)
 					char *http_dir_canonical = _fullpath(NULL, cur_listener->http_dir, 0);
 					const char sep = '\\';
 #else
-- 
2.52.0.windows.1

