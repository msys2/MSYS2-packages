pkgname=nyacc
pkgver=3.01.0
pkgrel=1
pkgdesc="NYACC (Not Yet Another Compiler Compiler)"
arch=(x86_64)
url="https://www.nongnu.org/nyacc/"
msys2_repository_url="https://github.com/mwette/nyacc"
license=('spdx:LGPL-3.0-or-later')
depends=(
  guile
)
makedepends=(
  gcc
)
source=(
  $pkgname-$pkgver.tar.gz::https://github.com/mwette/nyacc/archive/refs/tags/V$pkgver.tar.gz
)
sha512sums=(
  2e0c4d50160d1f22ac0be3eae21a001970ef01b78bec4aecbef50280e97284b8ec6975290ecbcee218576bbf688de00d99d651693f4f608289f7593ba3699a0f
)

prepare() {
  mkdir $pkgname-$pkgver/build
  cd    $pkgname-$pkgver/build
  ../configure
}

build() {
  make -C $pkgname-$pkgver/build -j$(nproc)
}

check() {
  make -C $pkgname-$pkgver/build check
}

package() {
  DESTDIR="$pkgdir" make -C $pkgname-$pkgver/build install

  install -Dm644 "$pkgname-$pkgver/COPYING" "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
}
