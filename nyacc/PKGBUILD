pkgname=nyacc
pkgver=3.01.1
pkgrel=1
pkgdesc="NYACC (Not Yet Another Compiler Compiler)"
arch=(x86_64)
url="https://www.nongnu.org/nyacc/"
msys2_repository_url="https://github.com/mwette/nyacc"
license=('spdx:LGPL-3.0-or-later')
depends=(
  guile
)
makedepends=(
  gcc
)
source=(
  $pkgname-$pkgver.tar.gz::https://github.com/mwette/nyacc/archive/refs/tags/V$pkgver.tar.gz
)
sha512sums=('ad6e6c9656a1aeb446ff855fdbfaaf5294ca3ce8cfeebbda60bf51709dc75a9d0a48432491c77549d591fa5347aa1274207156c02bda0afe4a00df0c63a6aa8e')

prepare() {
  mkdir $pkgname-$pkgver/build
  cd    $pkgname-$pkgver/build
  ../configure
}

build() {
  make -C $pkgname-$pkgver/build -j$(nproc)
}

check() {
  make -C $pkgname-$pkgver/build check
}

package() {
  DESTDIR="$pkgdir" make -C $pkgname-$pkgver/build install

  install -Dm644 "$pkgname-$pkgver/COPYING" "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
}
