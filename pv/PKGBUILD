# Maintainer: poxu <poxvuibr@gmail.com>

pkgname=pv
pkgver=1.10.2
pkgrel=1
pkgdesc="Pipe viewer"
arch=('i686' 'x86_64')
url="https://www.ivarch.com/programs/pv.shtml"
msys2_repository_url="https://codeberg.org/a-j-wood/pv"
msys2_changelog_url='https://codeberg.org/ivarch/pv/src/branch/main/docs/NEWS.md'
license=('spdx:GPL-3.0-or-later')
depends=('libintl')
makedepends=('autotools' 'gcc' 'gettext-devel')
source=(https://www.ivarch.com/programs/sources/pv-${pkgver}.tar.gz)
sha256sums=('3f7b47f0eaf66f9c2a487fc5dbc409cd00bfe5ecd8a9b198d76f1ed39f792dc9')

build () {
  [ -d ${srcdir}/build-${CHOST} ] && rm -rf ${srcdir}/build-${CHOST}
  mkdir ${srcdir}/build-${CHOST} && cd ${srcdir}/build-${CHOST}
  
  ../${pkgname}-${pkgver}/configure \
    --prefix=/usr \
    --build=${CHOST} \
    --host=${CHOST} \

  make
}

check () {
    cd ${srcdir}/build-${CHOST}
    make test
}

package () {
  cd build-${CHOST}
  make prefix="${pkgdir}/usr" install
}
